sap.ui.define(["sap/ui/core/UIComponent","./config","sap/ui/Device","./model/models","./modules/assetLoader","./modules/platform","./modules/pubsub","shortpoint-libs/js/shortpoint.min"],function(a,b,c,d,e,f,g,h){"use strict";var i=h.util;return h.settings.rss={url:"https://rss.shortpoint.com/api/getfeed"},a.extend([b.namespace,"Component"].join("."),{metadata:{manifest:"json"},init:function(){a.prototype.init.apply(this,arguments),this.setModel(d.createDeviceModel(),"device"),this.sCurrentRoute="render",this.oSaveDone=jQuery.Deferred(),this.oRouterInitialized=jQuery.Deferred(),this.oSettingsDone=jQuery.Deferred(),this.registerShortPointPreConfig(),this.sVersion=f.getProductVersion(this),window.shortpoint=window.shortpoint||{},window.shortpoint.sap={},window.shortpoint.sap.version=this.sVersion,this.oConfig=this.getMetadata().getConfig().shortpoint,this.loadShortPoint(),f.isWebIDEMode()&&this.createEditButton(),window.shortpointComponent=window.shortpointComponent||[],window.shortpointComponent.push(this)},registerShortPointPreConfig:function(){this.updateThemeParameters()},createEditButton:function(){var a=jQuery("<button>").addClass("ide-edit-button").text("edit").appendTo("body"),b=this;a.on("click",function(a){b.onEditButtonPress.call(b,a)})},updateThemeParameters:function(){var a,b=f.getThemeParam("sapButton_BorderWitdh")||f.getThemeParam("sapButton_BorderWidth"),c=f.getThemeParam("sapButton_BorderCornerRadius"),d=f.getThemeParam("sapBrandColor"),e=f.getThemeParam("sapButton_BorderColor");a="undefined"!=typeof h&&h.config?h.config:window.shortpoint_pre_config,a.colors=a.colors||{},a.colors.primary=d,a.colors.border=e,a.corners=c,a.border=a.border||{},a.border.size=b},onConfigChange:function(){this.publish("configChange");var a=new sap.ui.model.json.JSONModel,b=this.getMetadata().getManifest()["sap.cloud.portal"];b&&b.settings&&(b["sap.cloud.portal"]||(a.setData(this.getMetadata().getManifest()["sap.cloud.portal"].settings),this.oSaveDone.resolve(),this.onSettingsModelInit(a)))},onSettingsModelInit:function(a){if(a){var b=this.getModel("settings");if(b)return void b.setData(a.getData());var c=this,d=new sap.ui.model.Binding(a,"/",a.getContext("/"));d.attachChange(function(){c.onSettingsChange()}),this.setModel(a,"settings"),this.oRouterInitialized.resolve(),this.oSettingsDone.resolve(a.getData())}},onSettingsChange:function(){var a=this.getAggregation("rootControl"),b=this.getModel("settings"),c=b.getData(),d=c.markup.value;a.setContent(d)},getData:function(){return this.oSettingsDone},onEditButtonPress:function(a){this.navigateTo("edit").done(function(b){b.onEditButtonPress(a)}),f.hideWidgetMenu()},loadShortPoint:function(){var a=f.isRtl(),b=jQuery.sap.getModulePath("shortpoint-libs","/css/shortpoint-engine-{dir}.min.css");e.loadCss(b.replace(/{dir}/,a?"rtl":"ltr"))},navigateTo:function(a){var b,c,d=this.getAggregation("rootControl"),e=d.byId("renderMode"),f=d.byId("editMode"),g=jQuery.Deferred();return"edit"===a?(b=f,c=e):"render"===a&&(b=e,c=f),c.$().hide(),b.$().show(),this.sCurrentRoute=a,i.defer(function(){g.resolve(b.getController())},100),g},isEditMode:function(){return"edit"===this.sCurrentRoute},isRenderMode:function(){return"render"===this.sCurrentRoute},getModelData:function(){return f.isWebIDEMode()?window.shortpointContent||'[info color="warning"]Hello SAP[/info]':this.getModel("settings").getData().markup.value},saveContent:function(a){return this.oSaveDone=jQuery.Deferred(),this.fireEvent("save.settings",{markup:{value:a}}),f.isWebIDEMode()&&(window.shortpointContent=a,i.defer(function(){this.oSaveDone.resolve()},this)),this.oSaveDone},createContent:function(){return this.view=sap.ui.view({viewName:b.namespace+".view.App",type:sap.ui.core.mvc.ViewType.XML,async:!0}),this.view},publish:function(a,b){return g.publish(a,b,this)},subscribe:function(a,b,c){return g.subscribe(a,b,c,this)},unsubscribe:function(a,b,c){return g.unsubscribe(a,b,c,this)}})});