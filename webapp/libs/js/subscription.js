sap.ui.define(["./lm","./dm"],function(K0,I0){"use strict";var U0=window.shortPointInserter,H0=U0.util,L0=U0.ko,f1=U0.modules.getPrototype("moduleBase"),X0=' class="sp-inserter-btn sp-inserter-btn-primary sp-inserter-btn-lg"',C0=['<div id="spiSAPSubscription" class="spi-sap-subscription-root sp-inserter-full-height sp-inserter-subscription-module">','<div data-shortpoint-bind="if: l">','<div class="notification sp-inserter-alert sp-inserter-alert-warning">','	<strong>Loading</strong>','</div>','</div>','<div data-shortpoint-bind="ifnot: l">','<h2>Subscription</h1>','<div data-shortpoint-bind="html: a"></div>','<br />','<div data-shortpoint-bind="ifnot: r">','<h2>Activations</h1>','<p data-shortpoint-bind="html: d"></p>','<div class="sp-inserter-pull-right">','<button data-shortpoint-bind="visible: c, click: e"'+X0+'>Activate My License</button>','<a data-shortpoint-bind="visible: !c(), attr: { href: h }" target="_blank"'+X0+'>Buy from SAPStore.com</a>','<a data-shortpoint-bind="visible: !c()" href="http://support.shortpoint.com/support/tickets/new" target="_blank"'+X0+'>Licensing Inquires</a>','</div>','</div>','</div>'+'</div>'].join('\n');U0.module("sap-subscription",{options:{inheritBase:false},create:function(){f1.create.apply(this,arguments);var k=this;this.l=L0.observable(true);this.a=L0.observable(true);this.c=L0.observable(false);this.d=L0.observable(false);this.r=L0.observable(false);this.h=L0.observable('');this.e=function(){};shortpoint.subscribe("settingsDialogShown",function(){k.initData();});},show:function(){f1.show.apply(this,arguments);this.initData();},hide:function(){f1.hide.apply(this,arguments);},initData:function(){var g0=this,e0=false;if(g0.inited){return ;}g0.inited=true;var p0=g0.l,s0=g0.a,i0=g0.c,x0=g0.d,y0=g0.r,o0=g0.h;g0.e=P0;A0(K0.gf());G0();shortpoint.subscribe('buyLicenseUrlResolved',G0);function A0(k){k.then(B0).then(k0).fail(z0);}function G0(){o0(shortpoint.sap.buyLicenseUrl||'https://www.sapstore.com/search?text=shortpoint');}function B0(k){var n=new Date(),q=k.currentUserExpirationDate?new Date(k.currentUserExpirationDate):null,v='';if(q){v=' You current license will expire '+q.toDateString();}var z='<br><b>Please <a href="javascript:location.reload()">refresh the page</a>'+', in order to complete the activation process',a0='<div class="notification sp-inserter-alert spi-success">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-check-circle"></i> <div class="spi-subscription-text-wrap">'+'You have a valid license. '+v+(e0?z:'')+'</div></div>',d0=q&&q<n;if(d0){a0='<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> <div class="spi-subscription-text-wrap">Your license has expired'+'</div></div>';}F0(k,d0);s0(a0);}function z0(){y0(true);p0(false);s0('<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> '+'<div class="spi-subscription-text-wrap">Unexpected error occurred. Please, try again later'+'</div></div>');}function F0(k,n){var q=k.packageExpirationDate?new Date(k.packageExpirationDate):null,v=k.numOfActivationsAvailable,z=new Date(),a0=I0.u(),d0;if(!v||!q||q<z){i0(false);d0='<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> '+'<div class="spi-subscription-text-wrap">There are no activations available for your account'+'</div></div>';}else{i0(true);d0='<div class="notification sp-inserter-alert spi-info">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-info-circle"></i> '+'<div class="spi-subscription-text-wrap">'+v+' activations are available for this account and valid until '+q.toDateString();if(n){d0+='<br/>If you want to activate SAP License, press the button "Activate My License"'+'<br/>It will activate one license for '+a0.userName;}d0+='</div></div>';}x0(d0);}function k0(){p0(false);}function P0(){e0=true;p0(true);A0(K0.a());}}});return {template:C0};});