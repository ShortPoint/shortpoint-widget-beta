sap.ui.define(["./lm","./dm"],function(L0,J0){"use strict";var D0=window.shortPointInserter,K0=D0.util,N0=D0.ko,M0=D0.modules.getPrototype("moduleBase"),O0=' class="sp-inserter-btn sp-inserter-btn-primary sp-inserter-btn-lg"',x0=['<div id="spiSAPSubscription" class="spi-sap-subscription-root sp-inserter-full-height sp-inserter-subscription-module">','<div data-shortpoint-bind="if: l">','<div class="notification sp-inserter-alert sp-inserter-alert-warning">','	<strong>Loading</strong>','</div>','</div>','<div data-shortpoint-bind="ifnot: l">','<h2>Subscription</h1>','<div data-shortpoint-bind="html: a"></div>','<br />','<div data-shortpoint-bind="ifnot: r">','<h2>Activations</h1>','<p data-shortpoint-bind="html: d"></p>','<div class="sp-inserter-pull-right">','<button data-shortpoint-bind="visible: c, click: e"'+O0+'>Activate My License</button>','<a data-shortpoint-bind="visible: !c(), attr: { href: h }" target="_blank"'+O0+'>Buy from SAPStore.com</a>','<a data-shortpoint-bind="visible: !c()" href="http://support.shortpoint.com/support/tickets/new" target="_blank"'+O0+'>Licensing Inquires</a>','</div>','</div>','</div>'+'</div>'].join('\n');D0.module("sap-subscription",{options:{inheritBase:false},create:function(){M0.create.apply(this,arguments);var g=this;this.l=N0.observable(true);this.a=N0.observable(true);this.c=N0.observable(false);this.d=N0.observable(false);this.r=N0.observable(false);this.h=N0.observable('');this.e=function(){};shortpoint.subscribe("settingsDialogShown",function(){g.initData();});},show:function(){M0.show.apply(this,arguments);this.initData();},hide:function(){M0.hide.apply(this,arguments);},initData:function(){var e0=this,g0=false;if(e0.inited){return ;}e0.inited=true;var h0=e0.l,i0=e0.a,l0=e0.c,j0=e0.d,p0=e0.r,r0=e0.h;e0.e=k0;u0(L0.gf());s0();shortpoint.subscribe('buyLicenseUrlResolved',s0);function u0(g){g.then(y0).then(A0).fail(H0);}function s0(){r0(shortpoint.sap.buyLicenseUrl||'https://www.sapstore.com/search?text=shortpoint');}function y0(g){var j=new Date(),k=g.currentUserExpirationDate?new Date(g.currentUserExpirationDate):null,q='';if(k){q=' You current license will expire '+k.toDateString();}var z='<br><b>Please <a href="javascript:location.reload()">refresh the page</a>'+', in order to complete the activation process',b0='<div class="notification sp-inserter-alert spi-success">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-check-circle"></i> <div class="spi-subscription-text-wrap">'+'You have a valid license. '+q+(g0?z:'')+'</div></div>',c0=k&&k<j;if(c0){b0='<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> <div class="spi-subscription-text-wrap">Your license has expired'+'</div></div>';}B0(g,c0);i0(b0);}function H0(){p0(true);h0(false);i0('<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> '+'<div class="spi-subscription-text-wrap">Unexpected error occurred. Please, try again later'+'</div></div>');}function B0(g,j){var k=g.packageExpirationDate?new Date(g.packageExpirationDate):null,q=g.numOfActivationsAvailable,z=new Date(),b0=J0.u(),c0;if(!q||!k||k<z){l0(false);c0='<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> '+'<div class="spi-subscription-text-wrap">There are no activations available for your account'+'</div></div>';}else{l0(true);c0='<div class="notification sp-inserter-alert spi-info">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-info-circle"></i> '+'<div class="spi-subscription-text-wrap">'+q+' activations are available for this account and valid until '+k.toDateString();if(j){c0+='<br/>If you want to activate SAP License, press the button "Activate My License"'+'<br/>It will activate one license for '+b0.userName;}c0+='</div></div>';}j0(c0);}function A0(){h0(false);}function k0(){g0=true;h0(true);u0(L0.a());}}});return {template:x0};});