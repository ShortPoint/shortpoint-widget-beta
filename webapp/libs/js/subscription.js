sap.ui.define(["./lm","./dm"],function(a1,i1){"use strict";var l1=window.shortPointInserter,k1=l1.util,f1=l1.ko,p1=l1.modules.getPrototype("moduleBase"),u1=' class="sp-inserter-btn sp-inserter-btn-primary sp-inserter-btn-lg"',b0=['<div id="spiSAPSubscription" class="spi-sap-subscription-root sp-inserter-full-height sp-inserter-subscription-module">','<div data-shortpoint-bind="if: l">','<div class="notification sp-inserter-alert sp-inserter-alert-warning">','	<strong>Loading</strong>','</div>','</div>','<div data-shortpoint-bind="ifnot: l">','<h2>Subscription</h1>','<div data-shortpoint-bind="html: a"></div>','<br />','<div data-shortpoint-bind="ifnot: r">','<h2>Activations</h1>','<p data-shortpoint-bind="html: d"></p>','<div class="sp-inserter-pull-right">','<button data-shortpoint-bind="visible: c, click: e"'+u1+'>Activate My License</button>','<a data-shortpoint-bind="visible: !c(), attr: { href: h }" target="_blank"'+u1+'>Buy from SAPStore.com</a>','<a data-shortpoint-bind="visible: !c()" href="http://support.shortpoint.com/support/tickets/new" target="_blank"'+u1+'>Licensing Inquires</a>','</div>','</div>','</div>'+'</div>'].join('\n');l1.module("sap-subscription",{options:{inheritBase:false},create:function(){p1.create.apply(this,arguments);var a0=this;this.l=f1.observable(true);this.a=f1.observable(true);this.c=f1.observable(false);this.d=f1.observable(false);this.r=f1.observable(false);this.h=f1.observable('');this.e=function(){};shortpoint.subscribe("settingsDialogShown",function(){a0.initData();});},show:function(){p1.show.apply(this,arguments);this.initData();},hide:function(){p1.hide.apply(this,arguments);},initData:function(){var o0=this,q0=false;if(o0.inited){return ;}o0.inited=true;var t0=o0.l,v0=o0.a,z0=o0.c,A0=o0.d,D0=o0.r,B0=o0.h;o0.e=W0;N0(a1.gf());L0();shortpoint.subscribe('buyLicenseUrlResolved',L0);function N0(a0){a0.then(M0).then(R0).fail(Z0);}function L0(){B0(shortpoint.sap.buyLicenseUrl||'https://www.sapstore.com/search?text=shortpoint');}function M0(a0){var c0=new Date(),k=a0.currentUserExpirationDate?new Date(a0.currentUserExpirationDate):null,f0='';if(k){f0=' You current license will expire '+k.toDateString();}var q='<br><b>Please <a href="javascript:location.reload()">refresh the page</a>'+', in order to complete the activation process',i0='<div class="notification sp-inserter-alert spi-success">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-check-circle"></i> <div class="spi-subscription-text-wrap">'+'You have a valid license. '+f0+(q0?q:'')+'</div></div>',k0=k&&k<c0;if(k0){i0='<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> <div class="spi-subscription-text-wrap">Your license has expired'+'</div></div>';}Q0(a0,k0);v0(i0);}function Z0(){D0(true);t0(false);v0('<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> '+'<div class="spi-subscription-text-wrap">Unexpected error occurred. Please, try again later'+'</div></div>');}function Q0(a0,c0){var k=a0.packageExpirationDate?new Date(a0.packageExpirationDate):null,f0=a0.numOfActivationsAvailable,q=new Date(),i0=i1.u(),k0;if(!f0||!k||k<q){z0(false);k0='<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> '+'<div class="spi-subscription-text-wrap">There are no activations available for your account'+'</div></div>';}else{z0(true);k0='<div class="notification sp-inserter-alert spi-info">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-info-circle"></i> '+'<div class="spi-subscription-text-wrap">'+f0+' activations are available for this account and valid until '+k.toDateString();if(c0){k0+='<br/>If you want to activate SAP License, press the button "Activate My License"'+'<br/>It will activate one license for '+i0.userName;}k0+='</div></div>';}A0(k0);}function R0(){t0(false);}function W0(){q0=true;t0(true);N0(a1.a());}}});return {template:b0};});