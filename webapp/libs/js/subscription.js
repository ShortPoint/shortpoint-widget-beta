sap.ui.define(["./lm","./dm"],function(z0,A0){"use strict";var B0=window.shortPointInserter,y0=B0.util,C0=B0.ko,E0=B0.modules.getPrototype("moduleBase"),G0=' class="sp-inserter-btn sp-inserter-btn-primary sp-inserter-btn-lg"',D0=['<div id="spiSAPSubscription" class="spi-sap-subscription-root sp-inserter-full-height sp-inserter-subscription-module">','<div data-shortpoint-bind="if: l">','<div class="notification sp-inserter-alert sp-inserter-alert-warning">','	<strong>Loading</strong>','</div>','</div>','<div data-shortpoint-bind="ifnot: l">','<h2>Subscription</h1>','<div data-shortpoint-bind="html: a"></div>','<br />','<div data-shortpoint-bind="ifnot: r">','<h2>Activations</h1>','<p data-shortpoint-bind="html: d"></p>','<div class="sp-inserter-pull-right">','<button data-shortpoint-bind="visible: c, click: e"'+G0+'>Activate My License</button>','<a data-shortpoint-bind="visible: !c(), attr: { href: h }" target="_blank"'+G0+'>Buy from SAPStore.com</a>','<a data-shortpoint-bind="visible: !c()" href="http://support.shortpoint.com/support/tickets/new" target="_blank"'+G0+'>Licensing Inquires</a>','</div>','</div>','</div>'+'</div>'].join('\n');B0.module("sap-subscription",{options:{inheritBase:false},create:function(){E0.create.apply(this,arguments);var k=this;this.l=C0.observable(true);this.a=C0.observable(true);this.c=C0.observable(false);this.d=C0.observable(false);this.r=C0.observable(false);this.h=C0.observable('');this.e=function(){};shortpoint.subscribe("settingsDialogShown",function(){k.initData();});},show:function(){E0.show.apply(this,arguments);this.initData();},hide:function(){E0.hide.apply(this,arguments);},initData:function(){var d0=this,f0=false;if(d0.inited){return ;}d0.inited=true;var g0=d0.l,i0=d0.a,j0=d0.c,l0=d0.d,m0=d0.r,n0=d0.h;d0.e=u0;p0(z0.gf());r0();shortpoint.subscribe('buyLicenseUrlResolved',r0);function p0(k){k.then(s0).then(q0).fail(o0);}function r0(){n0(shortpoint.sap.buyLicenseUrl||'https://www.sapstore.com/search?text=shortpoint');}function s0(k){var a0=new Date(),c0=k.currentUserExpirationDate?new Date(k.currentUserExpirationDate):null,e0='';if(c0){e0=' You current license will expire '+c0.toDateString();}var q='<br><b>Please <a href="javascript:location.reload()">refresh the page</a>'+', in order to complete the activation process',h0='<div class="notification sp-inserter-alert spi-success">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-check-circle"></i> <div class="spi-subscription-text-wrap">'+'You have a valid license. '+e0+(f0?q:'')+'</div></div>',b0=c0&&c0<a0;if(b0){h0='<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> <div class="spi-subscription-text-wrap">Your license has expired'+'</div></div>';}t0(k,b0);i0(h0);}function o0(){m0(true);g0(false);i0('<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> '+'<div class="spi-subscription-text-wrap">Unexpected error occurred. Please, try again later'+'</div></div>');}function t0(k,a0){var c0=k.packageExpirationDate?new Date(k.packageExpirationDate):null,e0=k.numOfActivationsAvailable,q=new Date(),h0=A0.u(),b0;if(!e0||!c0||c0<q){j0(false);b0='<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> '+'<div class="spi-subscription-text-wrap">There are no activations available for your account'+'</div></div>';}else{j0(true);b0='<div class="notification sp-inserter-alert spi-info">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-info-circle"></i> '+'<div class="spi-subscription-text-wrap">'+e0+' activations are available for this account and valid until '+c0.toDateString();if(a0){b0+='<br/>If you want to activate SAP License, press the button "Activate My License"'+'<br/>It will activate one license for '+h0.userName;}b0+='</div></div>';}l0(b0);}function q0(){g0(false);}function u0(){f0=true;g0(true);p0(z0.a());}}});return {template:D0};});