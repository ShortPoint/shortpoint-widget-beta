sap.ui.define(["./lm","./dm"],function(p0,q0){"use strict";var t0=window.shortPointInserter,u0=t0.util,z0=t0.ko,G0=t0.modules.getPrototype("moduleBase"),A0=' class="sp-inserter-btn sp-inserter-btn-primary sp-inserter-btn-lg"',m0=['<div id="spiSAPSubscription" class="spi-sap-subscription-root sp-inserter-full-height sp-inserter-subscription-module">','<div data-shortpoint-bind="if: l">','<div class="notification sp-inserter-alert sp-inserter-alert-warning">','	<strong>Loading</strong>','</div>','</div>','<div data-shortpoint-bind="ifnot: l">','<h2>Subscription</h1>','<div data-shortpoint-bind="html: a"></div>','<br />','<div data-shortpoint-bind="ifnot: r">','<h2>Activations</h1>','<p data-shortpoint-bind="html: d"></p>','<div class="sp-inserter-pull-right">','<button data-shortpoint-bind="visible: c, click: e"'+A0+'>Activate My License</button>','<a data-shortpoint-bind="visible: !c(), attr: { href: h }" target="_blank"'+A0+'>Buy from SAPStore.com</a>','<a data-shortpoint-bind="visible: !c()" href="http://support.shortpoint.com/support/tickets/new" target="_blank"'+A0+'>Licensing Inquires</a>','</div>','</div>','</div>'+'</div>'].join('\n');t0.module("sap-subscription",{options:{inheritBase:false},create:function(){G0.create.apply(this,arguments);var v=this;this.l=z0.observable(true);this.a=z0.observable(true);this.c=z0.observable(false);this.d=z0.observable(false);this.r=z0.observable(false);this.h=z0.observable('');this.e=function(){};shortpoint.subscribe("settingsDialogShown",function(){v.initData();});},show:function(){G0.show.apply(this,arguments);this.initData();},hide:function(){G0.hide.apply(this,arguments);},initData:function(){var q=this,v0=false;if(q.inited){return ;}q.inited=true;var x0=q.l,a0=q.a,H0=q.c,J0=q.d,b0=q.r,I0=q.h;q.e=n0;c0(p0.gf());f0();shortpoint.subscribe('buyLicenseUrlResolved',f0);function c0(v){v.then(g0).then(k0).fail(i0);}function f0(){I0(shortpoint.sap.buyLicenseUrl||'https://www.sapstore.com/search?text=shortpoint');}function g0(v){var e0=new Date(),g=v.currentUserExpirationDate?new Date(v.currentUserExpirationDate):null,j0='';if(g){j0=' You current license will expire '+g.toDateString();}var j='<br><b>Please <a href="javascript:location.reload()">refresh the page</a>'+', in order to complete the activation process',k='<div class="notification sp-inserter-alert spi-success">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-check-circle"></i> <div class="spi-subscription-text-wrap">'+'You have a valid license. '+j0+(v0?j:'')+'</div></div>',w0=g&&g<e0;if(w0){k='<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> <div class="spi-subscription-text-wrap">Your license has expired'+'</div></div>';}l0(v,w0);a0(k);}function i0(){b0(true);x0(false);a0('<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> '+'<div class="spi-subscription-text-wrap">Unexpected error occurred. Please, try again later'+'</div></div>');}function l0(v,e0){var g=v.packageExpirationDate?new Date(v.packageExpirationDate):null,j0=v.numOfActivationsAvailable,j=new Date(),k=q0.u(),w0;if(!j0||!g||g<j){H0(false);w0='<div class="notification sp-inserter-alert spi-danger">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> '+'<div class="spi-subscription-text-wrap">There are no activations available for your account'+'</div></div>';}else{H0(true);w0='<div class="notification sp-inserter-alert spi-info">'+'<i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-info-circle"></i> '+'<div class="spi-subscription-text-wrap">'+j0+' activations are available for this account and valid until '+g.toDateString();if(e0){w0+='<br/>If you want to activate SAP License, press the button "Activate My License"'+'<br/>It will activate one license for '+k.userName;}w0+='</div></div>';}J0(w0);}function k0(){x0(false);}function n0(){v0=true;x0(true);c0(p0.a());}}});return {template:m0};});