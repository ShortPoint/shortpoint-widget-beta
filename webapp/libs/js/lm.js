sap.ui.define(["./dm"],function(z){"use strict";var a0=jQuery.Deferred,c0=30*1000,$=shortpoint.dom.lib,g0=shortpoint.util;function j0(){var q=z.gtld();t0(q);if(z0(q)){M0(q).then(function(g){var j=null,n=false;if(!g||g.error){if(!q){j=E0();}else{j=q;}}else{n=true;j=g;}q0(j,n);});}}function k0(){var g=z.gtld(),j=M0(g);return y0(j);}function o0(){var g=z.al();return y0(g);}function q0(g,j){if(j){G0(g);}z.svd(g).then(t0);}function y0(j){var n=a0();j.done(function(g){if(!g||g.error){n.reject();}else{q0(g,true);n.resolve(g);}}).fail(n.reject);return n;}function t0(g){var j=true,n=g||{};if(n.currentUserExpirationDate&&new Date(n.currentUserExpirationDate)<new Date()){j=false;for(var q in shortPointInserter.display.actions.list){if(q!=="delete"){delete  shortPointInserter.display.actions.list[q];}}shortPointInserter.display.destroy();shortPointInserter.display.init();var v=["demoContent","insertSection","insertShortPoint","upgrade","html"];for(q in v){delete  $.FroalaEditor.COMMANDS[v[q]];}$("html").addClass("spi-license-invalid");}if(j){shortpoint.config["font-class"]="serif";}else{delete  shortpoint.config["font-class"];}shortpoint.publish("newLicenseInfo",{isValid:j,licenseType:n.licenseType,expirationDate:n.currentUserExpirationDate});}function z0(g){if(!g||!g.lastCheckDate){return true;}var j=1000*60*60*24,n=(new Date()).getTime()-new Date(g.lastCheckDate).getTime();return n>j;}function M0(g){var j=null;if(g&&g.currentUserStartDate){j=g.currentUserStartDate;}return z.gtsd(j,c0);}function E0(){var g=new Date(),j=new Date(g.getTime());j.setDate(g.getDate()+30);var n={currentUserStartDate:g,currentUserExpirationDate:j,licenseType:"trial"};return n;}function G0(g){if(!g||g.error||!g.licenseType){return null;}g.lastCheckDate=new Date();return g;}return {c:j0,gf:k0,a:o0};});