sap.ui.define(["./dm"],function(S2){"use strict";var e5=jQuery.Deferred,c0=30*1000,$=shortpoint.dom.lib,f5=shortpoint.util;function s5(){var l3=S2.gtld();L5(l3);if(O5(l3)){M5(l3).then(function(j2){var E2=null,P2=false;if(!j2||j2.error){if(!l3){E2=P5();}else{E2=l3;}}else{P2=true;E2=j2;}K5(E2,P2);});}}function f0(){var j2=S2.gtld(),E2=M5(j2);return q(E2);}function N5(){var j2=S2.al();return q(j2);}function K5(j2,E2){if(E2){i0(j2);}S2.svd(j2).then(L5);}function q(E2){var P2=e5();E2.done(function(j2){if(!j2||j2.error){P2.reject();}else{K5(j2,true);P2.resolve(j2);}}).fail(P2.reject);return P2;}function L5(j2){var E2=true,P2=j2||{};if(P2.currentUserExpirationDate&&new Date(P2.currentUserExpirationDate)<new Date()){E2=false;for(var l3 in shortPointInserter.display.actions.list){if(l3!=="delete"){delete  shortPointInserter.display.actions.list[l3];}}shortPointInserter.display.destroy();shortPointInserter.display.init();var a0=["demoContent","insertSection","insertShortPoint","upgrade","html"];for(l3 in a0){delete  $.FroalaEditor.COMMANDS[a0[l3]];}$("html").addClass("spi-license-invalid");}if(E2){shortpoint.config["font-class"]="serif";}else{delete  shortpoint.config["font-class"];}shortpoint.publish("newLicenseInfo",{isValid:E2,licenseType:P2.licenseType,expirationDate:P2.currentUserExpirationDate});}function O5(j2){if(!j2||!j2.lastCheckDate){return true;}var E2=1000*60*60*24,P2=(new Date()).getTime()-new Date(j2.lastCheckDate).getTime();return P2>E2;}function M5(j2){var E2=null;if(j2&&j2.currentUserStartDate){E2=j2.currentUserStartDate;}return S2.gtsd(E2,c0);}function P5(){var j2=new Date(),E2=new Date(j2.getTime());E2.setDate(j2.getDate()+30);var P2={currentUserStartDate:j2,currentUserExpirationDate:E2,licenseType:"trial"};return P2;}function i0(j2){if(!j2||j2.error||!j2.licenseType){return null;}j2.lastCheckDate=new Date();return j2;}return {c:s5,gf:f0,a:N5};});