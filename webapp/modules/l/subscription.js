sap.ui.define(["./lm","./dm"],function(a,b){"use strict";var c=window.shortPointInserter,d=(c.util,c.ko),e=c.modules.getPrototype("moduleBase"),f=['<div id="spiSAPSubscription" class="spi-sap-subscription-root sp-inserter-full-height sp-inserter-subscription-module">','<div data-shortpoint-bind="if: l">','<div class="notification sp-inserter-alert sp-inserter-alert-warning">',"	<strong>Loading</strong>","</div>","</div>",'<div data-shortpoint-bind="ifnot: l">',"<h2>Subscription</h1>",'<div data-shortpoint-bind="html: a"></div>',"<br />",'<div data-shortpoint-bind="ifnot: r">',"<h2>Activations</h1>","<div>",'<p data-shortpoint-bind="html: d"></p>','<button data-shortpoint-bind="visible: c, click: e">Activate My License</button>','<button data-shortpoint-bind="visible: !c()">Buy from SAPStore.com</button>',"</div>","</div>","</div></div>"].join("\n");return c.module("sap-subscription",{options:{inheritBase:!1},create:function(){e.create.apply(this,arguments);var a=this;this.l=d.observable(!0),this.a=d.observable(!0),this.c=d.observable(!1),this.d=d.observable(!1),this.r=d.observable(!1),this.e=function(){},shortpoint.subscribe("settingsDialogShown",function(){a.initData()})},show:function(){e.show.apply(this,arguments),this.initData()},hide:function(){e.hide.apply(this,arguments)},initData:function(){function c(a){a.then(d).then(g).fail(e)}function d(a){var b=new Date,c=a.currentUserExpirationDate?new Date(a.currentUserExpirationDate):null,d="";c&&(d=" You current license will expire "+c.toDateString());var e='<div class="notification sp-inserter-alert spi-success"><i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-check-circle"></i> <div class="spi-subscription-text-wrap">You have a valid license.'+d+"</div></div>",g=c&&b>c;g&&(e='<div class="notification sp-inserter-alert spi-danger"><i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> <div class="spi-subscription-text-wrap">Your license has expired</div></div>'),f(a,g),k(e)}function e(){n(!0),j(!1),k('<div class="notification sp-inserter-alert spi-danger"><i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> <div class="spi-subscription-text-wrap">Unexpected error occurred. Please, try again later</div></div>')}function f(a,c){var d,e=a.packageExpirationDate?new Date(a.packageExpirationDate):null,f=a.numOfActivationsAvailable,g=new Date,h=b.u();d=!f||!e||g>e?'<div class="notification sp-inserter-alert spi-danger"><i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> <div class="spi-subscription-text-wrap">There are no activations available for your account</div></div>':'<div class="notification sp-inserter-alert spi-info"><i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-info-circle"></i> <div class="spi-subscription-text-wrap">'+f+" activations are available for this account and valid until "+e.toDateString()+'<br/>If you want to activate SAP License, press the button "Activate My License"<br/>It will activate one license for '+h.userName+"</div></div>",l(c),m(d)}function g(){j(!1)}function h(){j(!0),c(a.a())}var i=this;if(!i.inited){i.inited=!0;var j=i.l,k=i.a,l=i.c,m=i.d,n=i.r;i.e=h,c(a.gf())}}}),{template:f}});