sap.ui.define(["./lm","./dm"],function(a,b){"use strict";var c=window.shortPointInserter,d=(c.util,c.ko),e=c.modules.getPrototype("moduleBase"),f=' class="sp-inserter-btn sp-inserter-btn-primary sp-inserter-btn-lg"',g=['<div id="spiSAPSubscription" class="spi-sap-subscription-root sp-inserter-full-height sp-inserter-subscription-module">','<div data-shortpoint-bind="if: l">','<div class="notification sp-inserter-alert sp-inserter-alert-warning">',"	<strong>Loading</strong>","</div>","</div>",'<div data-shortpoint-bind="ifnot: l">',"<h2>Subscription</h1>",'<div data-shortpoint-bind="html: a"></div>',"<br />",'<div data-shortpoint-bind="ifnot: r">',"<h2>Activations</h1>",'<p data-shortpoint-bind="html: d"></p>','<div class="sp-inserter-pull-right">','<button data-shortpoint-bind="visible: c, click: e"'+f+">Activate My License</button>",'<button data-shortpoint-bind="visible: !c()"'+f+">Buy from SAPStore.com</button>","</div>","</div>","</div></div>"].join("\n");return c.module("sap-subscription",{options:{inheritBase:!1},create:function(){e.create.apply(this,arguments);var a=this;this.l=d.observable(!0),this.a=d.observable(!0),this.c=d.observable(!1),this.d=d.observable(!1),this.r=d.observable(!1),this.e=function(){},shortpoint.subscribe("settingsDialogShown",function(){a.initData()})},show:function(){e.show.apply(this,arguments),this.initData()},hide:function(){e.hide.apply(this,arguments)},initData:function(){function c(a){a.then(d).then(g).fail(e)}function d(a){var b=new Date,c=a.currentUserExpirationDate?new Date(a.currentUserExpirationDate):null,d="";c&&(d=" You current license will expire "+c.toDateString());var e='<br><b>Please <a href="javascript:location.reload()">refresh the page</a>, in order to complete the activation process',g='<div class="notification sp-inserter-alert spi-success"><i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-check-circle"></i> <div class="spi-subscription-text-wrap">You have a valid license. '+d+(j?e:"")+"</div></div>",h=c&&b>c;h&&(g='<div class="notification sp-inserter-alert spi-danger"><i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> <div class="spi-subscription-text-wrap">Your license has expired</div></div>'),f(a,h),l(g)}function e(){o(!0),k(!1),l('<div class="notification sp-inserter-alert spi-danger"><i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> <div class="spi-subscription-text-wrap">Unexpected error occurred. Please, try again later</div></div>')}function f(a,c){var d,e=a.packageExpirationDate?new Date(a.packageExpirationDate):null,f=a.numOfActivationsAvailable,g=new Date,h=b.u();!f||!e||g>e?d='<div class="notification sp-inserter-alert spi-danger"><i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-times-circle"></i> <div class="spi-subscription-text-wrap">There are no activations available for your account</div></div>':(d='<div class="notification sp-inserter-alert spi-info"><i class="shortpoint-icon shortpoint-icon-fa shortpoint-icon-fa-info-circle"></i> <div class="spi-subscription-text-wrap">'+f+" activations are available for this account and valid until "+e.toDateString(),c&&(d+='<br/>If you want to activate SAP License, press the button "Activate My License"<br/>It will activate one license for '+h.userName),d+="</div></div>"),m(c),n(d)}function g(){k(!1)}function h(){j=!0,k(!0),c(a.a())}var i=this,j=!1;if(!i.inited){i.inited=!0;var k=i.l,l=i.a,m=i.c,n=i.d,o=i.r;i.e=h,c(a.gf())}}}),{template:g}});